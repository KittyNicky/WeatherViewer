# Проект "Погода"

Веб-приложение для просмотра текущей погоды. Пользователь может зарегистрироваться и добавить в коллекцию один или несколько локаций (городов, сёл, других пунктов), после чего главная страница приложения начинает отображать список локаций с их текущей погодой.

### Главная страница

![image](https://github.com/user-attachments/assets/1b6d89a8-9502-494a-a218-b9f490e6a2fd)

- Заголовок
    - Для неавторизованных пользователей - кнопки авторизации (Sign in) и регистрации (Sign up).
    ![image](https://github.com/user-attachments/assets/fefe358b-97ef-436a-b207-23687640038a)
      При нажатии на кнопку авторизации происходит переход на страницу авторизации
    ![image](https://github.com/user-attachments/assets/8046d960-a15e-4aa7-8a1f-79e0d13f52a7)
      При нажатии на кнопку регистрации происходит переход на страницу регистрации
    ![image](https://github.com/user-attachments/assets/ba78b4b7-0bee-443c-a284-97c9923021fd)
    - Для авторизованных пользователей - логин текущего пользователя и кнопка Logout
    - Поле ввода для поиска локации по названию
- Контент
    - Список добавленных локаций. Каждый элемент списка отображает название, текущую, максимальную и минимальную температуры, восход и заход солнца, кнопку "Forecast" и "Remove". При нажатии на кнопку "Remove" происходит удаление локации из коллекции локаций пользователя и переход на главную страницу.

### Страница результатов поиска локаций по названию

![image](https://github.com/user-attachments/assets/72b53b6e-f7fb-44fc-a219-df3ea105c9df)

Переход на эту страницу осуществляется в результате заполнения поля ввода на главной странице, либо на странице результатов поиска. При нажатии на кнопку "Add" происходит добавление локации в коллекцию локаций пользователя и переход на главную страницу.


Содержимое:
- Заголовок, такой же как на главной странице
- Список найденных локаций. Каждый элемент списка отображает название, текущую, максимальную, минимальную и температуру по ощущениям, кнопки "Forecast" и "Add".


### Страница погоды по дням и с 3-х часовым интервалом
![image](https://github.com/user-attachments/assets/b09a2180-bd8c-43f9-9d79-d709d652454c)

Переход на эту страницу осуществляется в результате нажатия кнопки "Forecast" в карточке. Выводится топ-5 ближайших интервалов погоды 3-х часовым и по дням.

## Авторизация и регистрация

При авторизации пользователя бэкенд приложение создаёт сессию с идентификатор. Устанавливает этот идентификатор в cookies HTTP ответа, которым приложение отвечает на POST запрос формы авторизации. Далее, при каждом запросе к любой странице, бэкенд приложение анализирует cookies из запроса и определяет, существует ли сессия для ID из cookies. Если есть - страница рендерится для того пользователя, ID которого соответствует ID сессии из cookies.

## База данных

### Таблица `Users`

| Колонка  | Тип     | Комментарий                                                                                |
|----------|---------|--------------------------------------------------------------------------------------------|
| ID       | int     | Айди пользователя, автоинкремент, первичный ключ                                           |
| Login    | Varchar | Логин пользователя, username или email                                                     |
| Password | Varchar | Хранить пароль в открытом виде небезопасно, лучше использовать шифрование, например BCrypt |

### Таблица `Locations`

Локации пользователя, в которых он хочет знать погоду. Одна и та же локация может повторяться для нескольких пользователей.

| Колонка   | Тип           | Комментарий                                 |
|-----------|---------------|---------------------------------------------|
| ID        | int           | Айди локации, автоинкремент, первичный ключ |
| Name      | text          | Название                                    |
| UserId    | int           | Пользователь, добавивший эту локацию        |
| Latitude  | numeric(10,6) | Широта локации                              |
| Longitude | numeric(10,6) | Долгота локации                             |

### Таблица `Sessions`

| Колонка   | Тип       | Комментарий                                                          |
|-----------|-----------|----------------------------------------------------------------------|
| ID        | uuid      | Айди сессии, GUID, первичный ключ                                    |
| UserId    | int       | Пользователь, для которого сессия создана                            |
| ExpiresAt | timestamp | Время истечения сессии. Равно времени создания сессии плюс `N` часов |

## Получение информации о погоде с помощью OpenWeatherMap API

Документация - [https://openweathermap.org/api](https://openweathermap.org/api).

Используемые методы:
  - Поиск локаций по названию - [https://openweathermap.org/current#geocoding](https://openweathermap.org/current#geocoding)
  - Получение погоды по координатам локации - [https://openweathermap.org/current#one](https://openweathermap.org/current#one)
  - Получение погоды на 5 дней. Включает данные прогноза погоды с интервалом в 3 часа - [https://openweathermap.org/forecast5](https://openweathermap.org/forecast5)

